# 진학상담 양식 관리 시스템

Google Apps Script를 활용한 교사와 학생 간의 상담카드 데이터 동기화 자동화 도구입니다.

## 📋 프로젝트 개요

이 시스템은 교사가 관리하는 마스터 스프레드시트와 개별 학생들의 상담카드 파일 간의 양방향 데이터 동기화를 자동화합니다.

## ✨ 주요 기능

### 1. 자동 파일 생성 및 초기화
- 학생 목록을 기반으로 개별 상담카드 파일 자동 생성
- Google Drive 폴더 자동 생성 및 파일 정리
- 공유 권한 자동 설정 (편집 가능한 링크)

### 2. 양방향 데이터 동기화
- **교사 → 학생**: 마스터 시트 편집 시 해당 학생 파일에 자동 반영
- **학생 → 교사**: 학생이 수정한 내용을 마스터 시트로 가져오기
- 변경 감지 및 스마트 동기화 (수정된 파일만 업데이트)

### 3. 자동화된 관리
- 파일 열기 시 자동 동기화
- 시트 순서 자동 정렬 (번호순)
- 동기화 시간 추적 및 기록

## 🏗️ 시스템 구조

### 마스터 스프레드시트 구조

- **학생목록 시트**: 학생 정보 및 파일 링크 관리
  - A열: 번호
  - B열: 이름
  - C열: (예비)
  - D열: 파일 링크
  - E열: 마지막 동기화 시간
- **양식 시트**: 학생 파일 생성 시 사용할 템플릿
- **개별 학생 시트**: 각 학생별 상담 데이터

### 파일 구조
```
📁 학생 상담카드 (Google Drive 폴더)
├── 김철수.xlsx
├── 이영희.xlsx
└── ...
```

## 🚀 설치 및 설정

### 1. 초기 설정 (최초 1회)
1. Google Sheets에서 마스터 파일 생성
2. "학생목록", "양식" 시트 준비
3. Apps Script 에디터에서 코드 붙여넣기
4. 메뉴: `🚨 초기 설정 (최초 1회)` > `모든 학생 파일 생성 및 초기화`
5. 확인창에 "초기설정" 입력 후 실행

### 2. 일반 사용
- **자동 동기화**: 파일을 열 때마다 자동 실행
- **수동 동기화**: 메뉴 > `학생 데이터 관리` > `변경된 학생 데이터 불러오기`

## 📖 사용 방법

### 교사 관점
1. 마스터 시트에서 학생별 탭 편집
2. 저장 시 해당 학생 파일에 자동 동기화
3. 주기적으로 학생들의 변경사항 확인 및 가져오기

### 학생 관점
1. 교사가 공유한 개인 상담카드 링크 접근
2. 자유롭게 내용 편집 및 저장
3. 교사가 다음 동기화 시 변경사항 반영됨

## ⚙️ 주요 함수 설명

### 핵심 함수
- `createAndShareStudentSheets()`: 초기 파일 생성 및 설정
- `syncSheetOnEdit()`: 실시간 동기화 (교사→학생)
- `pullDataCore()`: 데이터 가져오기 핵심 로직
- `sortStudentSheets()`: 시트 순서 정렬

### 트리거 관리
- `enableOnEditTrigger()`: 편집 트리거 활성화
- `enableAutoSyncOnOpen()`: 자동 동기화 활성화
- `disableAutoSyncOnOpen()`: 자동 동기화 비활성화

## 🔧 설정 관리

### 자동 동기화 설정
- **켜기**: 메뉴 > `학생 데이터 관리` > `자동 동기화 켜기`
- **끄기**: 메뉴 > `학생 데이터 관리` > `자동 동기화 끄기`

### 수동 동기화
- 메뉴 > `학생 데이터 관리` > `변경된 학생 데이터 불러오기`

## 🛡️ 보안 및 권한

- 학생 파일: 링크를 아는 사용자 편집 가능
- 마스터 파일: 교사만 접근 가능
- 자동 백업: Google Drive 버전 관리 활용

## ⚠️ 주의사항

1. **초기 설정 시 주의**: 기존 파일이 있으면 덮어써집니다
2. **네트워크 상태**: 동기화 시 안정적인 인터넷 연결 필요
3. **권한 확인**: Apps Script 실행 권한 부여 필요
4. **데이터 백업**: 중요한 데이터는 별도 백업 권장

## 🔄 업데이트 로그

### v2.0 (구조 변경 대응)
- 시트 구조 변경에 따른 열 인덱스 수정
- 정렬 로직 개선
- 오류 처리 강화

### v1.0 (초기 버전)
- 기본 동기화 기능 구현
- 자동 파일 생성 기능
- 트리거 관리 시스템

## 🤝 기여 방법

1. Fork the repository
2. Create your feature branch
3. Commit your changes
4. Push to the branch
5. Create a Pull Request

## 📞 지원

문제가 발생하거나 개선사항이 있으시면 Issues에 등록해 주세요.

---

**개발자**: MCP 활용 클로드 시스템  
**라이선스**: MIT  
**최종 업데이트**: 2025.06.14
